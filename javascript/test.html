<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GeoJSON Map with D3</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        svg {
            width: 100%;
            height: 600px; /* Set map height */
        }
        .region {
            fill: steelblue; /* Default fill color */
            stroke: white;
            stroke-width: 1;
        }
        .region:hover {
            fill: orange; /* Change fill color on hover */
        }
    </style>
</head>
<body>

<svg id="map"></svg>

<script>
    // Set dimensions and create the SVG element
    const svg = d3.select("#map"),
          width = +svg.attr("width"),
          height = +svg.attr("height");

    // Define a projection
    const projection = d3.geoMercator()
                         .scale(10000) // Adjust scale for your data
                         .center([1.485, 41.472]); // Center coordinates;

    const path = d3.geoPath().projection(projection);

    // Create a g element to hold the map paths
    const g = svg.append("g");

    // Zoom behavior
    const zoom = d3.zoom()
                   .scaleExtent([1, 8]) // Set zoom scale limits
                   .on("zoom", (event) => {
                       g.attr("transform", event.transform);
                   });

    svg.call(zoom); // Apply zoom behavior to the SVG

    // Load GeoJSON data
    d3.json('geojson_files/comarques.geojson').then(data => {
        g.selectAll(".region")
           .data(data.features)
           .enter().append("path")
           .attr("class", "region")
           .attr("d", path)
           .on("mouseover", function(event, d) {
               d3.select(this).style("fill", "orange"); // Highlight on hover
               const tooltip = d3.select("body").append("div")
                   .attr("class", "tooltip")
                   .style("position", "absolute")
                   .style("background", "lightgrey")
                   .style("padding", "5px")
                   .style("border", "1px solid black")
                   .html(`NOMCOMAR: ${d.properties.NOMCOMAR}`)
                   .style("left", (event.pageX + 5) + "px")
                   .style("top", (event.pageY - 28) + "px");
           })
           .on("mouseout", function() {
               d3.select(this).style("fill", "steelblue"); // Reset color
               d3.selectAll(".tooltip").remove(); // Remove tooltip
           });
    }).catch(error => {
        console.error('Error loading GeoJSON:', error);
    });

</script>

</body>
</html>
